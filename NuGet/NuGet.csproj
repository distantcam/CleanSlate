<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003" ToolsVersion="4.0">
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{79BDFFC1-07B2-41E4-BA54-8A696D69C42E}</ProjectGuid>
    <ArtifactDir>$(SolutionDir)artifacts</ArtifactDir>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <ConfigurationName>Debug</ConfigurationName>
    <OutputPath>bin\Debug\</OutputPath>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <ConfigurationName>Release</ConfigurationName>
    <OutputPath>bin\Release\</OutputPath>
  </PropertyGroup>
  <ItemGroup>
    <ProjectReference Include="..\src\CleanSlate\CleanSlate.csproj">
      <Project>{230E8612-ED21-4D73-B42C-5F15B19ECD32}</Project>
      <Name>CleanSlate</Name>
    </ProjectReference>
  </ItemGroup>
  <ItemGroup>
    <Libs Include="..\src\CleanSlate\bin\$(Configuration)\CleanSlate.*">
      <InProject>false</InProject>
    </Libs>
    <SourceFiles Include="..\src\CleanSlate\**\*.cs">
      <InProject>false</InProject>
    </SourceFiles>
  </ItemGroup>
  <ItemGroup>
    <None Include="CleanSlate.nuspec">
      <SubType>Designer</SubType>
    </None>
  </ItemGroup>
  <Import Project="$(SolutionDir)Tools\GenerateCommonAssemblyInfo.targets" />
  <Target Name="Clean">
    <RemoveDir Directories="$(OutputPath)" />
  </Target>
  <Target Name="Build">
    <MakeDir Directories="$(OutputPath)" />
    <Copy SourceFiles="@(Libs)" DestinationFiles="@(Libs->'$(OutputPath)Lib\net40\%(Filename)%(Extension)')" />
    <Copy SourceFiles="@(SourceFiles)" DestinationFiles="@(SourceFiles->'$(OutputPath)src\%(RecursiveDir)\%(Filename)%(Extension)')" />
    <Copy SourceFiles="@(None)" DestinationFiles="@(None->'$(OutputPath)%(Filename)%(Extension)')" />

    <PropertyGroup>
      <NuGetCommand>$(SolutionDir)Tools\NuGet.exe</NuGetCommand>
      <BuildCommand>$(NuGetCommand) pack CleanSlate.nuspec -o "$(ArtifactDir)" -version "$(CurrentVersion)$(SemanticAssemblyConfig)$(SemanticBuildNumber)" -symbols</BuildCommand>
    </PropertyGroup>

    <MakeDir Directories="$(ArtifactDir)" />
    <Exec Command="$(BuildCommand)" WorkingDirectory="$(OutputPath)" LogStandardErrorAsError="true" />
  </Target>
  <Target Name="Rebuild" DependsOnTargets="Clean;Build" />
</Project>